import{b as d,f as m,o as f,k as g,q as b}from"./entry.3b733575.js";import{f as P,g as w,v as _,_ as k,s as u,i as F,c as s,h as p}from"./app-grid.vue.966bbd98.js";import"./button.esm.12e7dbab.js";import"./AppCard.9abe141a.js";import"./inputtext.esm.93aed4df.js";function h(t,e){if(t.length<=e)return t;const a=t.split("?")[0],r="...",o=e-r.length,i=a.substr(-o);return r+i}function y(t){return{...P,slots:{body:({data:e,field:a})=>{const r=e[a];if(!r)return[];const o=h(r,t);return[d("a",{target:"_blank",style:"text-decoration: underline; word-break: break-all;",href:r},[o])]}}}}function x(t){const e=y(t);return{...e,slots:{...e.slots,body:({data:a,field:r})=>{const o=a[r];if(!o)return[d("span",{style:"opacity: 0.5"},["Нажмите для ввода ссылки"])];const i=h(o,t);return[d("span",null,[i]),d("a",{target:"_blank",style:"text-decoration: underline; margin-left: 5px; word-break: break-all;",href:o},[d("i",{class:"pi pi-play"},null)])]},editor:w}}}const C=m({__name:"app-form-grid",props:{data:{},config:{}},setup(t){const e=t,a={title:e.config.title,basis:e.config.basis,hideSearch:e.config.hideSearch,allowUpdate:e.config.allowUpdate,allowAdd:()=>{e.data.push((e.config.newItemFunc??(()=>({})))(e.data.length))},allowDelete:r=>{var i;const o=e.data.findIndex(l=>l[e.config.dataKey]===r[e.config.dataKey]);o!==-1&&e.data.splice(o,1),(i=e.config.onDeleted)==null||i.call(void 0,r)},allowEdit:!0,props:{dataKey:e.config.dataKey,editMode:"cell",filterDisplay:void 0},emits:{"cell-edit-complete":r=>e.data[r.index][r.field]=r.newValue},getData:()=>Promise.resolve(e.data),hidePaging:!0,labels:e.config.labels,columns:{$validationOutcome:_(e.config.validationFunc),...e.config.columns}};return(r,o)=>(f(),g(b(k),{data:e.data,config:a},null,8,["data"]))}});function v(t){const e=[];return(!Number.isFinite(t.count)||t.count<1)&&e.push("Количество должно быть больше либо равно 1"),!t.url||!U(t.url)?e.push("Укажите ссылку на товар в формате https://site.com/some-product"):t.url.length>65536&&e.push("Максимальная длинна ссылки 65536"),e}function U(t){return/^(https?):\/\/(([^:\/?#\s]+)(?::(\d+))?)(\/[^?#\s]*)?(\?[^#\s]*)?(#\S*)?$/i.test(t)}const K=m({__name:"AppProductsGrid",props:{onUpdated:{type:Function},items:{},mode:{}},setup(t){const e=t;function a(){var n;for(let c=0;c<((n=e.items)==null?void 0:n.length);c++)e.items[c].id=c+1}const r={basis:"550px",title:"Товары от одного продавца",dataKey:"id",hideSearch:!0,allowUpdate:e.mode==="moder"?()=>e.onUpdated?e.onUpdated(e.items):Promise.resolve():void 0,allowAdd:e.mode==="new",allowEdit:e.mode==="new"||e.mode==="moder",allowDelete:e.mode==="new",onDeleted:()=>a(),newItemFunc:n=>({id:n+1,count:1}),validationFunc:v,labels:{id:"#",url:"Ссылка",count:"Количество",userPriceForOne:"Цена на сайте от заказчика",adminPriceForOne:"Цена на сайте от модератора (Приоритетнее)",resultPriceForOne:"Цена на сайте",priceToPay:"К оплате за штуку",priceToPayForAll:"К оплате за позицию",priceNet:"Цена нетто",priceGross:"Цена брутто (Старая)",priceMarkup:"Наценка",comment:"Комментарий"},columns:{id:u,url:e.mode==="new"?x(50):y(50),count:e.mode==="new"?F:u,userPriceForOne:l(e.mode),adminPriceForOne:i(e.mode),resultPriceForOne:s,priceToPay:o(e.mode),priceToPayForAll:s,priceNet:i(e.mode),priceGross:l(e.mode),priceMarkup:i(e.mode),comment:u}};function o(n){return n==="new"?!1:n==="moder"?p:s}function i(n){return n==="moder"?p:n==="moder-ro"?s:!1}function l(n){return n==="moder"?s:n==="moder-ro"?s:!1}return(n,c)=>(f(),g(b(C),{config:r,data:e.items},null,8,["data"]))}});export{K as _,y as l,v as p};
