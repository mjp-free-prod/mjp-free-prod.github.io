import{f as b,l as _,g,r as s,o as O,k as P,w as a,b as i,q as S,D as y,S as F}from"./entry.6d0ae791.js";import h from"./new-order-form.835ed535.js";import{A as k}from"./AppCardLayout.1e70ffc5.js";import"./AppCardGroup.c5011467.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./product-form.3deb9e2b.js";import"./button.esm.eb92d5ba.js";import"./index.esm.da4892cb.js";import"./AppCard.b8eca417.js";import"./order-form.c503f503.js";import"./WideButton.ab90e34d.js";const M=b({__name:"new-order-cards",setup(N){const l=_(),c=g(F),n=s(null),t=s({comment:"",products:[{url:"",count:1,userPriceForOne:null,comment:""}],shippingMethodId:null,vatDocumentRequired:!1});async function m(o){for(const e of o.products)e.url=e.url.trim(),e.count=u(e.count,0),e.userPriceForOne=u(e.userPriceForOne,2);const r=await c.set(async e=>e.rpc("addOrder",o),!1,"Заказ создан");r!=null&&r.id&&l.push("/user/my-order-info?orderId="+(r==null?void 0:r.id))}function u(o,r){const e=Number(o);return Number.isFinite(e)?Number(e.toFixed(r)):null}function d(o){return o.value.products.length>0}function p(o){t.value.products.splice(o,1)}function f(){t.value.products.push({url:"",count:1,userPriceForOne:null,comment:""})}function v(){var o;(o=n.value)==null||o.node.submit()}return(o,r)=>(O(),P(S(y),{ref_key:"form",ref:n,modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=e=>t.value=e),type:"form",validation:"atLeastOneProduct","validation-rules":{atLeastOneProduct:d},"validation-messages":{atLeastOneProduct:"Добавьте хотя бы один товар."},actions:!1,onSubmit:m},{default:a(()=>[i(k,null,{default:a(()=>{var e;return[i(h,{"msg-source":(e=n.value)==null?void 0:e.node,onAdd:f,onDelete:p,onSubmit:v},null,8,["msg-source"])]}),_:1})]),_:1},8,["modelValue","validation-rules","validation-messages"]))}});export{M as default};
