import{f as v,l as _,g as y,r as n,o as b,k as g,w as s,b as u,q as S,D as O,S as h}from"./entry.10c2110a.js";import{p as k}from"./index.88c16502.js";import w from"./new-order-form.c7d9847c.js";import{A as P}from"./AppCardLayout.96502c47.js";import"./button.esm.f5dc2763.js";import"./index.esm.2dd0d688.js";import"./AppCardGroup.48cb5379.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./product-form.9c9fdaaa.js";import"./AppCard.c61e841c.js";import"./order-form.a6514fdf.js";import"./WideButton.a9bbb5c4.js";const U=v({__name:"new-order-cards",setup(V){const i=_(),l=y(h),a=n(null),r=n({comment:"",products:[{url:"",count:1,userPriceForOne:null,comment:""}],shippingMethodId:null,vatDocumentRequired:!1});async function m(o){const e=await l.set(async t=>t.rpc("addOrder",o),!1,"Заказ создан");e!=null&&e.id&&i.push("/user/my-order-info?orderId="+(e==null?void 0:e.id))}function c(o){return o.value.products.length>0}function d(o){r.value.products.splice(o,1)}function p(){r.value.products.push({url:"",count:1,userPriceForOne:null,comment:""})}async function f(){var o;await k(100),(o=a.value)==null||o.node.submit()}return(o,e)=>(b(),g(S(O),{ref_key:"form",ref:a,modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),type:"form",validation:"atLeastOneProduct","validation-rules":{atLeastOneProduct:c},"validation-messages":{atLeastOneProduct:"Добавьте хотя бы один товар."},actions:!1,onSubmit:m},{default:s(()=>[u(P,null,{default:s(()=>{var t;return[u(w,{"msg-source":(t=a.value)==null?void 0:t.node,onAdd:p,onDelete:d,onSubmit:f},null,8,["msg-source"])]}),_:1})]),_:1},8,["modelValue","validation-rules","validation-messages"]))}});export{U as default};
