import{f as u,o as m,k as p,q as f}from"./entry.a6487435.js";import{v as g,_ as h,s as d,i as w,f as c,c as l}from"./app-grid.vue.3acadad1.js";import"./button.esm.12771107.js";import"./AppCard.92ec6dc2.js";import"./inputtext.esm.10aba614.js";import{a as _,l as y}from"./link-preset.202c3ee4.js";const P=u({__name:"app-form-grid",props:{data:{},config:{}},setup(o){const e=o,s={title:e.config.title,basis:e.config.basis,hideSearch:e.config.hideSearch,allowUpdate:e.config.allowUpdate,allowAdd:()=>{e.data.push((e.config.newItemFunc??(()=>({})))(e.data.length))},allowDelete:n=>{var i;const r=e.data.findIndex(t=>t[e.config.dataKey]===n[e.config.dataKey]);r!==-1&&e.data.splice(r,1),(i=e.config.onDeleted)==null||i.call(void 0,n)},allowEdit:!0,props:{dataKey:e.config.dataKey,editMode:"cell",filterDisplay:void 0},emits:{"cell-edit-complete":n=>e.data[n.index][n.field]=n.newValue},getData:()=>Promise.resolve(e.data),hidePaging:!0,labels:e.config.labels,columns:{$validationOutcome:g(e.config.validationFunc),...e.config.columns}};return(n,r)=>(m(),p(f(h),{data:e.data,config:s},null,8,["data"]))}});function x(o){const e=[];return(!Number.isFinite(o.count)||o.count<1)&&e.push("Количество должно быть больше либо равно 1"),!o.url||!b(o.url)?e.push("Укажите ссылку на товар в формате https://site.com/some-product"):o.url.length>65536&&e.push("Максимальная длинна ссылки 65536"),e}function b(o){return/^(https?):\/\/(([^:\/?#\s]+)(?::(\d+))?)(\/[^?#\s]*)?(\?[^#\s]*)?(#\S*)?$/i.test(o)}const N=u({__name:"AppProductsGrid",props:{onUpdated:{type:Function},items:{},mode:{}},setup(o){const e=o;function s(){var t;for(let a=0;a<((t=e.items)==null?void 0:t.length);a++)e.items[a].id=a+1}const n={basis:"550px",title:"Товары от одного продавца",dataKey:"id",hideSearch:!0,allowUpdate:e.mode==="moder"?()=>e.onUpdated?e.onUpdated(e.items):Promise.resolve():void 0,allowAdd:e.mode==="new",allowEdit:e.mode==="new"||e.mode==="moder",allowDelete:e.mode==="new",onDeleted:()=>s(),newItemFunc:t=>({id:t+1,count:1}),validationFunc:x,labels:{id:"#",url:"Ссылка",count:"Количество",priceToPay:"К оплате",priceNet:"Цена нетто",priceGross:"Цена брутто",priceMarkup:"Наценка"},columns:{id:d,url:e.mode==="new"?_(50):y(50),count:e.mode==="new"?w:d,priceToPay:r(e.mode),priceNet:i(e.mode),priceGross:i(e.mode),priceMarkup:i(e.mode)}};function r(t){return t==="new"?!1:t==="moder"?c:l}function i(t){return t==="moder"?c:t==="moder-ro"?l:!1}return(t,a)=>(m(),p(f(P),{config:n,data:e.items},null,8,["data"]))}});export{N as _,x as p};
